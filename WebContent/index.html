<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="UTF-8">
<title>MiniHack v1</title>

<script src="http://code.jquery.com/jquery-latest.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
	integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
	crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
	integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
	crossorigin="anonymous"></script>


<link href="style.css" rel="stylesheet">

<script src="bootstrap_typeahead.js"></script>

<!-- JS file -->
<script src="resources/EasyAutocomplete-1.3.5/jquery.easy-autocomplete.min.js"></script> 

<!-- CSS file -->
<link rel="stylesheet" href="resources/EasyAutocomplete-1.3.5/easy-autocomplete.min.css"> 

<!-- Additional CSS Themes file - not required-->
<link rel="stylesheet" href="resources/EasyAutocomplete-1.3.5/easy-autocomplete.themes.min.css"> 

</head>

<body>

	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="input-group" id="adv-search">
					<input id="locationSearchField" type="text" class="form-control"
						data-provide="typeahead" placeholder="Search for location" />
					<div class="input-group-btn">
						<div class="btn-group" role="group">
							<div class="dropdown dropdown-lg">
								<button type="button" class="btn btn-default dropdown-toggle"
									data-toggle="dropdown" aria-expanded="false">
									Filters <span class="caret"></span>
								</button>
								<div class="dropdown-menu dropdown-menu-right" role="menu">
									<form class="form-horizontal" role="form">
										<div class="form-group">
											<label for="filter">Max price</label> <select
												class="form-control">
												<option value="0" selected>Any</option>
												<option value="1">400 pcm</option>
												<option value="2">500 pcm</option>
												<option value="3">600 pcm</option>
												<option value="4">700 pcm</option>
												<option value="5">800 pcm</option>
												<option value="6">900 pcm</option>
												<option value="7">1000 pcm</option>

											</select>
										</div>
										<div class="form-group">
											<label for="filter">Max travel time</label> <select
												class="form-control">
												<option value="0" selected>Any</option>
												<option value="1">10 mins</option>
												<option value="2">20 mins</option>
												<option value="3">30 mins</option>
												<option value="4">45 mins</option>
												<option value="5">An hour</option>
											</select>
										</div>
										<div class="form-group">
											<label for="contain">Tags</label> <input class="form-control"
												type="text" />
										</div>
										<button type="submit" class="btn btn-primary">
											<span class="glyphicon glyphicon-search" aria-hidden="true">
											</span> Search
										</button>
									</form>
								</div>
							</div>
							<button type="button" class="btn btn-primary">
								<span class="glyphicon glyphicon-search" aria-hidden="true"></span>
								Search
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>

	<div id="map"></div>

	<script>
	
		$(document).ready(function(e) {
			$('.search-panel .dropdown-menu').find('a').click(function(e) {
				e.preventDefault();
				var param = $(this).attr("href").replace("#", "");
				var concept = $(this).text();
				$(this).text(concept);
				$(this).val(param);
			});
		});

		var options = {
			enableHighAccuracy : true,
			timeout : 5000,
			maximumAge : 0
		};

		function error(err) {
			console.warn(`ERROR(${err.code}): ${err.message}`);
		};

		navigator.geolocation.getCurrentPosition(initMap, error, options);

		function initMap(pos) {
			var crd = pos.coords;
			var currentPosition = {
				lat : crd.latitude,
				lng : crd.longitude
			};
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom : 15,
				center : currentPosition
			});

			var marker = new google.maps.Marker({
				position : currentPosition,
				map : map
			});

			var nearLocation = {
				lat : crd.latitude + 0.01,
				lng : crd.longitude + 0.01
			};
			var marker = new google.maps.Marker({
				position : nearLocation,
				map : map
			});
		}
	</script>

	<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDVoI-brTjE9Q0qzkyb0di0f-pty2dtVKg&callback=initMap">
		
	</script>

</body>

</html>

<script>
	$(document).ready(function() {
		$('#map').css('height', $(window).height());
	});
	
	$(window).resize(function() {
		$('#map').css('height', $(window).height());
	});
		
	$("#locationSearchField").keypress(function() {
		console.log("keyboard is pressed");
			$.ajax({
			    url: "/MiniHack_1/services/findPlace?input=" + $(this).val(),
			    type: 'GET',
			    success: function(response) {
			    		var options = {
			    				data:$.parseJSON(response),
			    				list: {	
			    				    match: {
			    				      enabled: true
			    				    }
			    				  },

			    				  theme: "square"
					};
					
			    		console.log(options);
			    		$("#locationSearchField").easyAutocomplete(options);
				}
			});
	});
</script>







